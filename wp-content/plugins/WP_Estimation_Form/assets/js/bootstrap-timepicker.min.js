
/*!
 * Timepicker Component for Twitter Bootstrap
 *
 * Copyright 2013 Joris de Wit and bootstrap-timepicker contributors
 *
 * Contributors https://github.com/jdewit/bootstrap-timepicker/graphs/contributors
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */
(function(d,c,a){var b=function(f,e){this.widget="";this.$element=d(f);this.defaultTime=e.defaultTime;this.disableFocus=e.disableFocus;this.disableMousewheel=e.disableMousewheel;this.isOpen=e.isOpen;this.minuteStep=e.minuteStep;this.modalBackdrop=e.modalBackdrop;this.orientation=e.orientation;this.secondStep=e.secondStep;this.snapToStep=e.snapToStep;this.showInputs=e.showInputs;this.showMeridian=e.showMeridian;this.showSeconds=e.showSeconds;this.template=e.template;this.appendWidgetTo=e.appendWidgetTo;this.showWidgetOnAddonClick=e.showWidgetOnAddonClick;this.icons=e.icons;this.maxHours=e.maxHours;this.explicitMode=e.explicitMode;this.handleDocumentClick=function(h){var g=h.data.scope;if(!(g.$element.parent().find(h.target).length||g.$widget.is(h.target)||g.$widget.find(h.target).length)){g.hideWidget()}};this._init()};b.prototype={constructor:b,_init:function(){var e=this;if(this.showWidgetOnAddonClick&&(this.$element.parent().hasClass("input-group")&&this.$element.parent().hasClass("bootstrap-timepicker"))){this.$element.parent(".input-group.bootstrap-timepicker").find(".input-group-addon").on({"click.timepicker":d.proxy(this.showWidget,this)});this.$element.on({"focus.timepicker":d.proxy(this.highlightUnit,this),"click.timepicker":d.proxy(this.highlightUnit,this),"keydown.timepicker":d.proxy(this.elementKeydown,this),"blur.timepicker":d.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":d.proxy(this.mousewheel,this)})}else{if(this.template){this.$element.on({"focus.timepicker":d.proxy(this.showWidget,this),"click.timepicker":d.proxy(this.showWidget,this),"blur.timepicker":d.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":d.proxy(this.mousewheel,this)})}else{this.$element.on({"focus.timepicker":d.proxy(this.highlightUnit,this),"click.timepicker":d.proxy(this.highlightUnit,this),"keydown.timepicker":d.proxy(this.elementKeydown,this),"blur.timepicker":d.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":d.proxy(this.mousewheel,this)})}}if(this.template!==false){this.$widget=d(this.getTemplate()).on("click",d.proxy(this.widgetClick,this))}else{this.$widget=false}if(this.showInputs&&this.$widget!==false){this.$widget.find("input").each(function(){d(this).on({"click.timepicker":function(){d(this).select()},"keydown.timepicker":d.proxy(e.widgetKeydown,e),"keyup.timepicker":d.proxy(e.widgetKeyup,e)})})}this.setDefaultTime(this.defaultTime)},blurElement:function(){this.highlightedUnit=null;this.updateFromElementVal()},clear:function(){this.hour="";this.minute="";this.second="";this.meridian="";this.$element.val("")},decrementHour:function(){if(this.showMeridian){if(this.hour===1){this.hour=12}else{if(this.hour===12){this.hour--;return this.toggleMeridian()}else{if(this.hour===0){this.hour=11;return this.toggleMeridian()}else{this.hour--}}}}else{if(this.hour<=0){this.hour=this.maxHours-1}else{this.hour--}}},decrementMinute:function(f){var e;if(f){e=this.minute-f}else{e=this.minute-this.minuteStep}if(e<0){this.decrementHour();this.minute=e+60}else{this.minute=e}},decrementSecond:function(){var e=this.second-this.secondStep;if(e<0){this.decrementMinute(true);this.second=e+60}else{this.second=e}},elementKeydown:function(f){switch(f.which){case 9:if(f.shiftKey){if(this.highlightedUnit==="hour"){this.hideWidget();break}this.highlightPrevUnit()}else{if((this.showMeridian&&this.highlightedUnit==="meridian")||(this.showSeconds&&this.highlightedUnit==="second")||(!this.showMeridian&&!this.showSeconds&&this.highlightedUnit==="minute")){this.hideWidget();break}else{this.highlightNextUnit()}}f.preventDefault();this.updateFromElementVal();break;case 27:this.updateFromElementVal();break;case 37:f.preventDefault();this.highlightPrevUnit();this.updateFromElementVal();break;case 38:f.preventDefault();switch(this.highlightedUnit){case"hour":this.incrementHour();this.highlightHour();break;case"minute":this.incrementMinute();this.highlightMinute();break;case"second":this.incrementSecond();this.highlightSecond();break;case"meridian":this.toggleMeridian();this.highlightMeridian();break}this.update();break;case 39:f.preventDefault();this.highlightNextUnit();this.updateFromElementVal();break;case 40:f.preventDefault();switch(this.highlightedUnit){case"hour":this.decrementHour();this.highlightHour();break;case"minute":this.decrementMinute();this.highlightMinute();break;case"second":this.decrementSecond();this.highlightSecond();break;case"meridian":this.toggleMeridian();this.highlightMeridian();break}this.update();break}},getCursorPosition:function(){var f=this.$element.get(0);if("selectionStart" in f){return f.selectionStart}else{if(a.selection){f.focus();var g=a.selection.createRange(),e=a.selection.createRange().text.length;g.moveStart("character",-f.value.length);return g.text.length-e}}},getTemplate:function(){var g,i,f,e,h,j;if(this.showInputs){i='<input type="text" class="bootstrap-timepicker-hour" maxlength="2"/>';f='<input type="text" class="bootstrap-timepicker-minute" maxlength="2"/>';e='<input type="text" class="bootstrap-timepicker-second" maxlength="2"/>';h='<input type="text" class="bootstrap-timepicker-meridian" maxlength="2"/>'}else{i='<span class="bootstrap-timepicker-hour"></span>';f='<span class="bootstrap-timepicker-minute"></span>';e='<span class="bootstrap-timepicker-second"></span>';h='<span class="bootstrap-timepicker-meridian"></span>'}j='<table><tr><td><a href="#" data-action="incrementHour"><span class="'+this.icons.up+'"></span></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><span class="'+this.icons.up+'"></span></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><span class="'+this.icons.up+'"></span></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><span class="'+this.icons.up+'"></span></a></td>':"")+"</tr><tr><td>"+i+'</td> <td class="separator">:</td><td>'+f+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+e+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+h+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><span class="'+this.icons.down+'"></span></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><span class="'+this.icons.down+'"></span></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><span class="'+this.icons.down+'"></span></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><span class="'+this.icons.down+'"></span></a></td>':"")+"</tr></table>";switch(this.template){case"modal":g='<div class="bootstrap-timepicker-widget modal hide fade in" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">&times;</a><h3>Pick a Time</h3></div><div class="modal-content">'+j+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">OK</a></div></div>';break;case"dropdown":g='<div class="bootstrap-timepicker-widget ">'+j+"</div>";break}return g},getHour:function(){return this.hour},getTime:function(){if(this.hour===""){return""}return this.hour+":"+(this.minute.toString().length===1?"0"+this.minute:this.minute)+(this.showSeconds?":"+(this.second.toString().length===1?"0"+this.second:this.second):"")+(this.showMeridian?" "+this.meridian:"")},hideWidget:function(){if(this.isOpen===false){return}this.$element.trigger({type:"hide.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}});if(this.template==="modal"&&this.$widget.modal){this.$widget.modal("hide")}else{this.$widget.removeClass("open")}d(a).off("mousedown.timepicker, touchend.timepicker",this.handleDocumentClick);this.isOpen=false;this.$widget.detach()},highlightUnit:function(){this.position=this.getCursorPosition();if(this.position>=0&&this.position<=2){this.highlightHour()}else{if(this.position>=3&&this.position<=5){this.highlightMinute()}else{if(this.position>=6&&this.position<=8){if(this.showSeconds){this.highlightSecond()}else{this.highlightMeridian()}}else{if(this.position>=9&&this.position<=11){this.highlightMeridian()}}}}},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":if(this.showSeconds){this.highlightSecond()}else{if(this.showMeridian){this.highlightMeridian()}else{this.highlightHour()}}break;case"second":if(this.showMeridian){this.highlightMeridian()}else{this.highlightHour()}break;case"meridian":this.highlightHour();break}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":if(this.showMeridian){this.highlightMeridian()}else{if(this.showSeconds){this.highlightSecond()}else{this.highlightMinute()}}break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":if(this.showSeconds){this.highlightSecond()}else{this.highlightMinute()}break}},highlightHour:function(){var e=this.$element.get(0),f=this;this.highlightedUnit="hour";if(e.setSelectionRange){setTimeout(function(){if(f.hour<10){e.setSelectionRange(0,1)}else{e.setSelectionRange(0,2)}},0)}},highlightMinute:function(){var e=this.$element.get(0),f=this;this.highlightedUnit="minute";if(e.setSelectionRange){setTimeout(function(){if(f.hour<10){e.setSelectionRange(2,4)}else{e.setSelectionRange(3,5)}},0)}},highlightSecond:function(){var e=this.$element.get(0),f=this;this.highlightedUnit="second";if(e.setSelectionRange){setTimeout(function(){if(f.hour<10){e.setSelectionRange(5,7)}else{e.setSelectionRange(6,8)}},0)}},highlightMeridian:function(){var e=this.$element.get(0),f=this;this.highlightedUnit="meridian";if(e.setSelectionRange){if(this.showSeconds){setTimeout(function(){if(f.hour<10){e.setSelectionRange(8,10)}else{e.setSelectionRange(9,11)}},0)}else{setTimeout(function(){if(f.hour<10){e.setSelectionRange(5,7)}else{e.setSelectionRange(6,8)}},0)}}},incrementHour:function(){if(this.showMeridian){if(this.hour===11){this.hour++;return this.toggleMeridian()}else{if(this.hour===12){this.hour=0}}}if(this.hour===this.maxHours-1){this.hour=0;return}this.hour++},incrementMinute:function(f){var e;if(f){e=this.minute+f}else{e=this.minute+this.minuteStep-(this.minute%this.minuteStep)}if(e>59){this.incrementHour();this.minute=e-60}else{this.minute=e}},incrementSecond:function(){var e=this.second+this.secondStep-(this.second%this.secondStep);if(e>59){this.incrementMinute(true);this.second=e-60}else{this.second=e}},mousewheel:function(g){if(this.disableMousewheel){return}g.preventDefault();g.stopPropagation();var h=g.originalEvent.wheelDelta||-g.originalEvent.detail,f=null;if(g.type==="mousewheel"){f=(g.originalEvent.wheelDelta*-1)}else{if(g.type==="DOMMouseScroll"){f=40*g.originalEvent.detail}}if(f){g.preventDefault();d(this).scrollTop(f+d(this).scrollTop())}switch(this.highlightedUnit){case"minute":if(h>0){this.incrementMinute()}else{this.decrementMinute()}this.highlightMinute();break;case"second":if(h>0){this.incrementSecond()}else{this.decrementSecond()}this.highlightSecond();break;case"meridian":this.toggleMeridian();this.highlightMeridian();break;default:if(h>0){this.incrementHour()}else{this.decrementHour()}this.highlightHour();break}return false},changeToNearestStep:function(f,e){if(f%e===0){return f}if(Math.round((f%e)/e)){return(f+(e-f%e))%60}else{return f-f%e}},place:function(){if(this.isInline){return}var g=this.$widget.outerWidth(),n=this.$widget.outerHeight(),i=10,k=d(c).width(),f=d(c).height(),j=d(c).scrollTop();var q=parseInt(this.$element.parents().filter(function(){return d(this).css("z-index")!=="auto"}).first().css("z-index"),10)+10;var m=this.component?this.component.parent().offset():this.$element.offset();var r=this.component?this.component.outerHeight(true):this.$element.outerHeight(false);var h=this.component?this.component.outerWidth(true):this.$element.outerWidth(false);var l=m.left,p=m.top;this.$widget.removeClass("timepicker-orient-top timepicker-orient-bottom timepicker-orient-right timepicker-orient-left");if(this.orientation.x!=="auto"){this.$widget.addClass("timepicker-orient-"+this.orientation.x);if(this.orientation.x==="right"){l-=g-h}}else{this.$widget.addClass("timepicker-orient-left");if(m.left<0){l-=m.left-i}else{if(m.left+g>k){l=k-g-i}}}var e=this.orientation.y,o,s;if(e==="auto"){o=-j+m.top-n;s=j+f-(m.top+r+n);if(Math.max(o,s)===s){e="top"}else{e="bottom"}}this.$widget.addClass("timepicker-orient-"+e);if(e==="top"){p+=r}else{p-=n+parseInt(this.$widget.css("padding-top"),10)}this.$widget.css({top:p,left:l,zIndex:q})},remove:function(){d("document").off(".timepicker");if(this.$widget){this.$widget.remove()}delete this.$element.data().timepicker},setDefaultTime:function(g){if(!this.$element.val()){if(g==="current"){var e=new Date(),f=e.getHours(),i=e.getMinutes(),j=e.getSeconds(),h="AM";if(j!==0){j=Math.ceil(e.getSeconds()/this.secondStep)*this.secondStep;if(j===60){i+=1;j=0}}if(i!==0){i=Math.ceil(e.getMinutes()/this.minuteStep)*this.minuteStep;if(i===60){f+=1;i=0}}if(this.showMeridian){if(f===0){f=12}else{if(f>=12){if(f>12){f=f-12}h="PM"}else{h="AM"}}}this.hour=f;this.minute=i;this.second=j;this.meridian=h;this.update()}else{if(g===false){this.hour=0;this.minute=0;this.second=0;this.meridian="AM"}else{this.setTime(g)}}}else{this.updateFromElementVal()}},setTime:function(k,i){if(!k){this.clear();return}var e,j,f,l,g,h;if(typeof k==="object"&&k.getMonth){f=k.getHours();l=k.getMinutes();g=k.getSeconds();if(this.showMeridian){h="AM";if(f>12){h="PM";f=f%12}if(f===12){h="PM"}}}else{e=((/a/i).test(k)?1:0)+((/p/i).test(k)?2:0);if(e>2){this.clear();return}j=k.replace(/[^0-9\:]/g,"").split(":");f=j[0]?j[0].toString():j.toString();if(this.explicitMode&&f.length>2&&(f.length%2)!==0){this.clear();return}l=j[1]?j[1].toString():"";g=j[2]?j[2].toString():"";if(f.length>4){g=f.slice(-2);f=f.slice(0,-2)}if(f.length>2){l=f.slice(-2);f=f.slice(0,-2)}if(l.length>2){g=l.slice(-2);l=l.slice(0,-2)}f=parseInt(f,10);l=parseInt(l,10);g=parseInt(g,10);if(isNaN(f)){f=0}if(isNaN(l)){l=0}if(isNaN(g)){g=0}if(g>59){g=59}if(l>59){l=59}if(f>=this.maxHours){f=this.maxHours-1}if(this.showMeridian){if(f>12){e=2;f-=12}if(!e){e=1}if(f===0){f=12}h=e===1?"AM":"PM"}else{if(f<12&&e===2){f+=12}else{if(f>=this.maxHours){f=this.maxHours-1}else{if((f<0)||(f===12&&e===1)){f=0}}}}}this.hour=f;if(this.snapToStep){this.minute=this.changeToNearestStep(l,this.minuteStep);this.second=this.changeToNearestStep(g,this.secondStep)}else{this.minute=l;this.second=g}this.meridian=h;this.update(i)},showWidget:function(){if(this.isOpen){return}if(this.$element.is(":disabled")){return}this.$widget.appendTo(this.appendWidgetTo);d(a).on("mousedown.timepicker, touchend.timepicker",{scope:this},this.handleDocumentClick);this.$element.trigger({type:"show.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}});this.place();if(this.disableFocus){this.$element.blur()}if(this.hour===""){if(this.defaultTime){this.setDefaultTime(this.defaultTime)}else{this.setTime("0:0:0")}}if(this.template==="modal"&&this.$widget.modal){this.$widget.modal("show").on("hidden",d.proxy(this.hideWidget,this))}else{if(this.isOpen===false){this.$widget.addClass("open")}}this.isOpen=true},toggleMeridian:function(){this.meridian=this.meridian==="AM"?"PM":"AM"},update:function(e){this.updateElement();if(!e){this.updateWidget()}this.$element.trigger({type:"changeTime.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}})},updateElement:function(){this.$element.val(this.getTime()).change()},updateFromElementVal:function(){this.setTime(this.$element.val())},updateWidget:function(){if(this.$widget===false){return}var e=this.hour,g=this.minute.toString().length===1?"0"+this.minute:this.minute,f=this.second.toString().length===1?"0"+this.second:this.second;if(this.showInputs){this.$widget.find("input.bootstrap-timepicker-hour").val(e);this.$widget.find("input.bootstrap-timepicker-minute").val(g);if(this.showSeconds){this.$widget.find("input.bootstrap-timepicker-second").val(f)}if(this.showMeridian){this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)}}else{this.$widget.find("span.bootstrap-timepicker-hour").text(e);this.$widget.find("span.bootstrap-timepicker-minute").text(g);if(this.showSeconds){this.$widget.find("span.bootstrap-timepicker-second").text(f)}if(this.showMeridian){this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian)}}},updateFromWidgetInputs:function(){if(this.$widget===false){return}var e=this.$widget.find("input.bootstrap-timepicker-hour").val()+":"+this.$widget.find("input.bootstrap-timepicker-minute").val()+(this.showSeconds?":"+this.$widget.find("input.bootstrap-timepicker-second").val():"")+(this.showMeridian?this.$widget.find("input.bootstrap-timepicker-meridian").val():"");this.setTime(e,true)},widgetClick:function(g){g.stopPropagation();g.preventDefault();var h=d(g.target),f=h.closest("a").data("action");if(f){this[f]()}this.update();if(h.is("input")){h.get(0).setSelectionRange(0,2)}},widgetKeydown:function(g){var h=d(g.target),f=h.attr("class").replace("bootstrap-timepicker-","");switch(g.which){case 9:if(g.shiftKey){if(f==="hour"){return this.hideWidget()}}else{if((this.showMeridian&&f==="meridian")||(this.showSeconds&&f==="second")||(!this.showMeridian&&!this.showSeconds&&f==="minute")){return this.hideWidget()}}break;case 27:this.hideWidget();break;case 38:g.preventDefault();switch(f){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian();break}this.setTime(this.getTime());h.get(0).setSelectionRange(0,2);break;case 40:g.preventDefault();switch(f){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian();break}this.setTime(this.getTime());h.get(0).setSelectionRange(0,2);break}},widgetKeyup:function(f){if((f.which===65)||(f.which===77)||(f.which===80)||(f.which===46)||(f.which===8)||(f.which>=48&&f.which<=57)||(f.which>=96&&f.which<=105)){this.updateFromWidgetInputs()}}};d.fn.timepicker=function(f){var e=Array.apply(null,arguments);e.shift();return this.each(function(){var i=d(this),h=i.data("timepicker"),g=typeof f==="object"&&f;if(!h){i.data("timepicker",(h=new b(this,d.extend({},d.fn.timepicker.defaults,g,d(this).data()))))}if(typeof f==="string"){h[f].apply(h,e)}})};d.fn.timepicker.defaults={defaultTime:"current",disableFocus:false,disableMousewheel:false,isOpen:false,minuteStep:15,modalBackdrop:false,orientation:{x:"auto",y:"auto"},secondStep:15,snapToStep:false,showSeconds:false,showInputs:true,showMeridian:true,template:"dropdown",appendWidgetTo:"body",showWidgetOnAddonClick:true,icons:{up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down"},maxHours:24,explicitMode:false};d.fn.timepicker.Constructor=b;d(a).on("focus.timepicker.data-api click.timepicker.data-api",'[data-provide="timepicker"]',function(g){var f=d(this);if(f.data("timepicker")){return}g.preventDefault();f.timepicker()})})(jQuery,window,document);