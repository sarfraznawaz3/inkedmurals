jQuery(function(t){var o={lastSelectedButton:!1,options:{success:function(t){o.afterFileSelected(t)},linkType:"preview",multiselect:!0},init:function(){this.checkBrowserSupport()&&(this.addButtons(),this.addButtonEventHandler(),t("#variable_product_options").on("woocommerce_variations_added",function(){o.addButtons(),o.addButtonEventHandler()}),t("#woocommerce-product-data").on("woocommerce_variations_loaded",function(){o.addButtons(),o.addButtonEventHandler()}))},checkBrowserSupport:function(){return"undefined"!=typeof Dropbox&&Dropbox.isBrowserSupported()},addButtons:function(){var o=t('<a href="#" class="button insert-dropbox">'+woocommerce_dropbox_translation.choose_from_dropbox+"</a>");t(".downloadable_files").each(function(n){var e=t(this).find("a.button.insert");t(this).find("a.button.insert-dropbox").length||e.after(o.clone())})},addButtonEventHandler:function(){t("a.button.insert-dropbox").on("click",function(n){n.preventDefault(),o.lastSelectedButton=t(this),Dropbox.choose(o.options)})},afterFileSelected:function(n){var e=t(o.lastSelectedButton).closest(".downloadable_files").find("tbody"),a=t(o.lastSelectedButton).prev(".button.insert").data("row");_.each(n,function(o){var n=t(a);n.find(".file_name > input").val(o.name).change(),n.find(".file_url > input").val(o.link.replace("dl=0","dl=1")),e.append(n)}),t(e).find("input").last().change()}};o.init()});