jQuery(function(a){function b(){a(".wc-bundled-items .wc-bundled-item").each(function(b,c){a(".item_menu_order",c).val(b)})}function c(b){var c=["product","cart","order"],d=!1;a.each(c,function(a,c){b.find("input.visibility_"+c).is(":checked")?(b.find("input.price_visibility_"+c).css("opacity",1),d=!0):b.find("input.price_visibility_"+c).css("opacity",.5)})}function d(){a(".wc-bundled-items").on("change",".priced_individually input",function(){a(this).is(":checked")?(a(this).closest("div.item-data").find(".discount").show(),a(this).closest("div.item-data").find(".price_visibility").show()):(a(this).closest("div.item-data").find(".discount").hide(),a(this).closest("div.item-data").find(".price_visibility").hide())}).on("change",".override_variations input",function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.allowed_variations").show():a(this).closest("div.item-data").find("div.allowed_variations").hide()}).on("change",".override_default_variation_attributes input",function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.default_variation_attributes").show():a(this).closest("div.item-data").find("div.default_variation_attributes").hide()}).on("change",".override_title input",function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.custom_title").show():a(this).closest("div.item-data").find("div.custom_title").hide()}).on("change",".override_description input",function(){a(this).is(":checked")?a(this).closest("div.item-data").find("div.custom_description").show():a(this).closest("div.item-data").find("div.custom_description").hide()}).on("change","input.visibility_product",function(){a(this).is(":checked")?(a(this).closest("div.item-data").find(".override_title, .override_description, .hide_thumbnail").show(),a(this).closest("div.item-data").find(".override_title input").change(),a(this).closest("div.item-data").find(".override_description input").change()):a(this).closest("div.item-data").find(".override_title, .custom_title, .override_description, .custom_description, .hide_thumbnail").hide(),c(a(this).closest("div.item-data"))}).on("change","input.visibility_cart, input.visibility_order",function(){c(a(this).closest("div.item-data"))}),a(".wc-bundled-items .priced_individually input").change(),a(".wc-bundled-items .override_variations input").change(),a(".wc-bundled-items .override_default_variation_attributes input").change(),a(".wc-bundled-items .override_title input").change(),a(".wc-bundled-items .override_description input").change(),a(".wc-bundled-items input.visibility_product").change();var d=a(".wc-bundled-items").find(".wc-bundled-item").get();d.sort(function(b,c){var d=parseInt(a(b).attr("rel")),e=parseInt(a(c).attr("rel"));return d<e?-1:d>e?1:0}),a(d).each(function(b,c){a(".wc-bundled-items").append(c)}),a(".wc-bundled-items").sortable({items:".wc-bundled-item",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(a,b){b.item.css("background-color","#f6f6f6")},stop:function(a,c){c.item.removeAttr("style"),b()}}),b(),a(".wc-bundle-metaboxes-wrapper",e).on("click","a.remove_row",function(c){var d=a(this).closest(".wc-bundled-item");d.find("*").off(),d.remove(),b(),c.preventDefault()}),a(".expand_all",e).click(function(){return a(this).closest(".wc-metaboxes-wrapper").find(".wc-metabox > .item-data").show(),!1}),a(".close_all",e).click(function(){return a(this).closest(".wc-metaboxes-wrapper").find(".wc-metabox > .item-data").hide(),!1})}var e=a("#bundled_product_data"),f=a("#bundled_product",e);a.fn.wc_bundles_select2=function(){a(document.body).trigger("wc-enhanced-select-init")},a(".bundle_stock_msg").appendTo("._manage_stock_field .description"),a("#_sold_individually").closest(".form-field").addClass("hide_if_bundle"),a("#linked_product_data .grouping.show_if_simple, #linked_product_data .form-field.show_if_grouped").addClass("hide_if_bundle"),a(".show_if_simple:not(.hide_if_bundle)").addClass("show_if_bundle"),a("body").on("woocommerce-product-type-change",function(b,c,d){"bundle"===c&&(a(".show_if_external").hide(),a(".show_if_bundle").show(),a("input#_manage_stock").change(),a("#_nyp").change(),"no"===wc_bundles_admin_params.is_wc_version_gte_2_7&&(a("#_regular_price").val(a("#_wc_pb_base_regular_price").val()).change(),a("#_sale_price").val(a("#_wc_pb_base_sale_price").val()).change()))}),a("select#product-type").change(),a("input#_downloadable").change(function(){a("select#product-type").change()}),d(),a("#wc-bundle-metaboxes-wrapper-inner").on("click",".subsubsub a",function(){a(this).closest(".subsubsub").find("a").removeClass("current"),a(this).addClass("current"),a(this).closest(".wc-bundled-item").find(".options_group").addClass("options_group_hidden");var b=a(this).data("tab");return a(this).closest(".wc-bundled-item").find(".options_group_"+b).removeClass("options_group_hidden"),!1});var g=a(".wc-bundled-items .wc-bundled-item",e).length,h={message:null,overlayCSS:{background:"#fff",opacity:.6}};e.on("click","button.add_bundled_product",function(){var d=f.val();if(!d>0)return f.select2("open"),!1;"yes"===wc_bundles_admin_params.is_wc_version_gte_2_7?f.val("").change():f.select2("val",""),e.block(h),g++;var i={action:"woocommerce_add_bundled_product",post_id:woocommerce_admin_meta_boxes.post_id,id:g,product_id:d,security:wc_bundles_admin_params.add_bundled_product_nonce};return a.post(woocommerce_admin_meta_boxes.ajax_url,i,function(d){if(""!==d.markup){a(".wc-bundled-items",e).append(d.markup),b();var f=a(".wc-bundled-items .wc-bundled-item",e).last();f.find(".override_variations input").change(),f.find(".override_default_variation_attributes input").change(),f.find(".override_title input").change(),f.find(".override_description input").change(),c(f),f.find(".woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),f.wc_bundles_select2(),e.trigger("wc-bundles-added-bundled-product")}else""!==d.message&&window.alert(d.message);e.unblock()}),!1})});